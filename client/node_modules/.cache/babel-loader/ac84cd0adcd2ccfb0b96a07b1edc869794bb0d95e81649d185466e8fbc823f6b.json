{"ast":null,"code":"import { Brush, Circle, Eraser, Rect, Line } from '../tools/ToolsRouter';\nimport canvasState from '../store/canvasState';\nimport toolState from '../store/toolState';\nexport const sokcetMessageHandler = msg => {\n  var _toolState$tool, _toolState$tool2, _toolState$tool3;\n  const figure = msg.figure;\n  if (!canvasState.checkForExist()) return;\n  const [canvas, ctx, socket, id] = [canvasState.canvas, canvasState.ctx, canvasState.socket, canvasState.id];\n  if (!id || !ctx || !canvas || !socket || !toolState.tool) return;\n  switch (figure.type) {\n    case 'brush':\n      if (((_toolState$tool = toolState.tool) === null || _toolState$tool === void 0 ? void 0 : _toolState$tool.toolName) === 'brush' && toolState.tool instanceof Brush) {\n        toolState.tool.draw(ctx, figure.x, figure.y);\n      } else {\n        toolState.setTool(new Brush(canvas, socket, ctx, id));\n        if (!toolState.tool || !(toolState.tool instanceof Brush)) return;\n        toolState.tool.draw(ctx, figure.x, figure.y);\n      }\n      break;\n    case 'eraser':\n      if (((_toolState$tool2 = toolState.tool) === null || _toolState$tool2 === void 0 ? void 0 : _toolState$tool2.toolName) === 'eraser' && toolState.tool instanceof Brush) {\n        toolState.tool.draw(ctx, figure.x, figure.y);\n      } else {\n        toolState.setTool(new Eraser(canvas, socket, ctx, id));\n        if (!toolState.tool || !(toolState.tool instanceof Eraser)) return;\n        toolState.tool.draw(ctx, figure.x, figure.y);\n      }\n      break;\n    case 'rect':\n      if (!figure.w || !figure.h) return;\n      if (toolState.tool.getTool === 'rect' && toolState.tool instanceof Rect) {\n        toolState.tool.savedCanvas = canvas.toDataURL();\n        toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\n      } else {\n        toolState.setTool(new Rect(canvas, socket, ctx, id));\n        if (!toolState.tool || !(toolState.tool instanceof Rect)) return;\n        toolState.tool.savedCanvas = canvas.toDataURL();\n        toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\n      }\n      break;\n    case 'circle':\n      if (!figure.w || !figure.h) return;\n      if (toolState.tool.getTool === 'circle' && toolState.tool instanceof Circle) {\n        toolState.tool.savedCanvas = canvas.toDataURL();\n        toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\n      } else {\n        toolState.setTool(new Circle(canvas, socket, ctx, id));\n        if (!toolState.tool || !(toolState.tool instanceof Circle)) return;\n        toolState.tool.savedCanvas = canvas.toDataURL();\n        toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\n      }\n      break;\n    case 'line':\n      if (!figure.w || !figure.h) return;\n      if (((_toolState$tool3 = toolState.tool) === null || _toolState$tool3 === void 0 ? void 0 : _toolState$tool3.toolName) === 'line' && toolState.tool instanceof Line) {\n        toolState.tool.savedCanvas = canvas.toDataURL();\n        toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\n      } else {\n        toolState.setTool(new Line(canvas, socket, ctx, id));\n        if (!toolState.tool || !(toolState.tool instanceof Line)) return;\n        toolState.tool.savedCanvas = canvas.toDataURL();\n        toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\n      }\n      break;\n    default:\n      break;\n  }\n};","map":{"version":3,"names":["Brush","Circle","Eraser","Rect","Line","canvasState","toolState","sokcetMessageHandler","msg","_toolState$tool","_toolState$tool2","_toolState$tool3","figure","checkForExist","canvas","ctx","socket","id","tool","type","toolName","draw","x","y","setTool","w","h","getTool","savedCanvas","toDataURL","staticDraw"],"sources":["C:/Users/mistR/OneDrive/Рабочий стол/React/ts/paint-ts/client/src/sokcet/drawHandler.ts"],"sourcesContent":["import {MessageDrawI} from '../model/msgI';\r\nimport { Brush, Circle, Eraser, Rect, Line } from '../tools/ToolsRouter';\r\nimport canvasState from '../store/canvasState';\r\nimport toolState from '../store/toolState';\r\n\r\n\r\nexport const sokcetMessageHandler = (msg: MessageDrawI) => {\r\n    const figure = msg.figure;\r\n    if(!canvasState.checkForExist()) return;\r\n    const [canvas, ctx, socket, id] = [canvasState.canvas, canvasState.ctx, canvasState.socket, canvasState.id];\r\n\r\n    if(!id || !ctx || !canvas || !socket || !toolState.tool) return;\r\n\r\n    switch (figure.type) {\r\n        case 'brush':\r\n            if(toolState.tool?.toolName === 'brush' && toolState.tool instanceof Brush) {\r\n                toolState.tool.draw(ctx, figure.x, figure.y);\r\n            } else {\r\n                toolState.setTool(new Brush(canvas, socket, ctx, id));\r\n                if(!toolState.tool || !(toolState.tool instanceof Brush) ) return;\r\n                toolState.tool.draw(ctx, figure.x, figure.y);\r\n              \r\n            }\r\n            break;\r\n            \r\n        case 'eraser':\r\n            if(toolState.tool?.toolName === 'eraser' && toolState.tool instanceof Brush) {\r\n                toolState.tool.draw(ctx, figure.x, figure.y);\r\n               \r\n            } else {\r\n                toolState.setTool(new Eraser(canvas, socket, ctx, id));\r\n                if(!toolState.tool || !(toolState.tool instanceof Eraser) ) return;\r\n                toolState.tool.draw(ctx, figure.x, figure.y);\r\n            }\r\n            break;\r\n\r\n        case 'rect':\r\n            if(!figure.w || !figure.h) return;\r\n\r\n            if(toolState.tool.getTool === 'rect' && toolState.tool instanceof Rect) {\r\n                toolState.tool.savedCanvas = canvas.toDataURL();\r\n                toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\r\n            } else {\r\n                toolState.setTool(new Rect(canvas, socket, ctx, id));\r\n                if(!toolState.tool || !(toolState.tool instanceof Rect) ) return;\r\n\r\n                toolState.tool.savedCanvas = canvas.toDataURL();\r\n                toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\r\n            }\r\n            break;\r\n\r\n        case 'circle':\r\n            if(!figure.w || !figure.h) return;\r\n\r\n            if(toolState.tool.getTool === 'circle' && toolState.tool instanceof Circle) {\r\n                toolState.tool.savedCanvas = canvas.toDataURL();\r\n                toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\r\n            } else {\r\n                toolState.setTool(new Circle(canvas, socket, ctx, id));\r\n                if(!toolState.tool || !(toolState.tool instanceof Circle) ) return;\r\n\r\n                toolState.tool.savedCanvas = canvas.toDataURL();\r\n                toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\r\n            }\r\n            break;\r\n\r\n        case 'line':\r\n            if(!figure.w || !figure.h) return;\r\n\r\n            if(toolState.tool?.toolName === 'line' && toolState.tool instanceof Line) {\r\n                toolState.tool.savedCanvas = canvas.toDataURL();\r\n                toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\r\n            } else {\r\n                toolState.setTool(new Line(canvas, socket, ctx, id));\r\n                if(!toolState.tool || !(toolState.tool instanceof Line) ) return;\r\n            \r\n                toolState.tool.savedCanvas = canvas.toDataURL();\r\n                toolState.tool.staticDraw(ctx, figure.x, figure.y, figure.w, figure.h);\r\n            }\r\n            break;\r\n\r\n        default:\r\n            break;\r\n    }\r\n}  \r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}