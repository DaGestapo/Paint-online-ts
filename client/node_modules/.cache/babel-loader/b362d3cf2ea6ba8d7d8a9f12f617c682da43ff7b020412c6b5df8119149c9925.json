{"ast":null,"code":"export default class Tool {\n  constructor(canvas, socket, ctx, id) {\n    this.canvas = void 0;\n    this.ctx = void 0;\n    this.socket = void 0;\n    this.toolName = void 0;\n    this.id = void 0;\n    this.img = void 0;\n    this.startX = 0;\n    this.startY = 0;\n    this.currentX = 0;\n    this.currentY = 0;\n    this.savedCanvas = void 0;\n    this.canvas = canvas;\n    this.socket = socket;\n    this.toolName = 'tool';\n    this.id = id;\n    this.ctx = ctx;\n    this.savedCanvas = this.saveCanvas();\n    this.delete();\n    this.listen();\n  }\n  get getToolName() {\n    return this.toolName;\n  }\n  set fillColor(color) {\n    if (color.startsWith('#')) {\n      this.ctx.fillStyle = color;\n    }\n  }\n  set styleColor(color) {\n    if (color.startsWith('#')) {\n      this.ctx.strokeStyle = color;\n    }\n  }\n  set lineWidth(width) {\n    this.ctx.lineWidth = width;\n  }\n  saveToLocalStorage(src) {\n    const store = localStorage.getItem(this.id) ? localStorage.getItem(this.id) : null;\n    let undoArr = [];\n    if (!src) {\n      src = this.saveCanvas();\n    }\n    if (!store) {\n      undoArr.push(src);\n    } else {\n      undoArr = JSON.parse(store).undo;\n      undoArr.push(src);\n    }\n    localStorage.setItem(this.id, JSON.stringify({\n      current: this.saveCanvas(),\n      undo: undoArr,\n      redo: []\n    }));\n  }\n  saveCanvas() {\n    return this.canvas.toDataURL();\n  }\n  setColor(color) {\n    if (color.startsWith('#')) {\n      this.ctx.strokeStyle = color;\n      this.ctx.fillStyle = color;\n    }\n  }\n  listen() {\n    this.canvas.onpointerdown = this.pointerdownHandler.bind(this);\n    this.canvas.onpointermove = this.pointerMoveHandler.bind(this);\n    this.canvas.onpointerup = this.pointerUpHandler.bind(this);\n  }\n  delete() {\n    this.canvas.onpointerdown = null;\n    this.canvas.onpointermove = null;\n    this.canvas.onpointerup = null;\n  }\n}","map":{"version":3,"names":["Tool","constructor","canvas","socket","ctx","id","toolName","img","startX","startY","currentX","currentY","savedCanvas","saveCanvas","delete","listen","getToolName","fillColor","color","startsWith","fillStyle","styleColor","strokeStyle","lineWidth","width","saveToLocalStorage","src","store","localStorage","getItem","undoArr","push","JSON","parse","undo","setItem","stringify","current","redo","toDataURL","setColor","onpointerdown","pointerdownHandler","bind","onpointermove","pointerMoveHandler","onpointerup","pointerUpHandler"],"sources":["C:/Users/mistR/OneDrive/Рабочий стол/React/ts/paint-ts/client/src/tools/Tool.ts"],"sourcesContent":["\r\nexport default class Tool {\r\n    protected canvas: HTMLCanvasElement;\r\n    protected ctx: CanvasRenderingContext2D;\r\n    protected socket: WebSocket;\r\n    protected toolName: string;\r\n    protected id: string;\r\n    protected img?: HTMLImageElement;\r\n    protected startX: number = 0;\r\n    protected startY: number = 0;\r\n    protected currentX: number = 0;\r\n    protected currentY: number = 0;\r\n    public savedCanvas: string;\r\n\r\n    constructor(canvas: HTMLCanvasElement, socket: WebSocket, ctx: CanvasRenderingContext2D, id: string) {\r\n        this.canvas = canvas;\r\n        this.socket = socket;\r\n        this.toolName = 'tool';\r\n        this.id = id;\r\n        this.ctx = ctx;\r\n        this.savedCanvas = this.saveCanvas();\r\n        this.delete();\r\n        this.listen();\r\n    }\r\n\r\n    get getToolName(): string {\r\n        return this.toolName;\r\n    }\r\n\r\n    set fillColor(color: string) {\r\n        if(color.startsWith('#')) {\r\n            this.ctx.fillStyle = color;\r\n        }\r\n    }\r\n\r\n    set styleColor(color: string) {\r\n        if(color.startsWith('#')) {\r\n            this.ctx.strokeStyle = color;\r\n        }\r\n    }\r\n\r\n    set lineWidth(width: number) {\r\n        this.ctx.lineWidth = width;\r\n    }\r\n\r\n    public saveToLocalStorage(src?: string) {\r\n        const store = localStorage.getItem(this.id)\r\n        ? localStorage.getItem(this.id)\r\n        : null;\r\n        let undoArr: string[] = [];\r\n\r\n        if(!src) {\r\n            src = this.saveCanvas();\r\n        }\r\n\r\n        if(!store) {\r\n            undoArr.push(src);\r\n        } else {\r\n            undoArr = JSON.parse(store).undo;\r\n            undoArr.push(src);\r\n        }\r\n\r\n        localStorage.setItem(this.id, JSON.stringify({\r\n            current: this.saveCanvas(),\r\n            undo: undoArr,\r\n            redo: []\r\n        }));\r\n    }\r\n\r\n    protected saveCanvas(): string {\r\n        return this.canvas.toDataURL();\r\n    }\r\n\r\n    public setColor(color: string) {\r\n        if(color.startsWith('#')) {\r\n            this.ctx.strokeStyle = color;\r\n            this.ctx.fillStyle = color;\r\n        }\r\n    }\r\n\r\n    protected listen() {\r\n        this.canvas.onpointerdown = this.pointerdownHandler.bind(this);\r\n        this.canvas.onpointermove = this.pointerMoveHandler.bind(this);\r\n        this.canvas.onpointerup = this.pointerUpHandler.bind(this);\r\n    }\r\n\r\n    private delete() {\r\n        this.canvas.onpointerdown = null;\r\n        this.canvas.onpointermove = null;\r\n        this.canvas.onpointerup = null;\r\n    }\r\n}\r\n\r\n\r\nexport type typedTool = Tool;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}