{"ast":null,"code":"import canvasState from '../store/canvasState';\nimport toolState from '../store/toolState';\nimport { sokcetMessageHandler } from './drawHandler';\nconst changeSetting = msg => {\n  const options = msg.option;\n  switch (options.type) {\n    case 'color':\n      if (!options.color) return;\n      toolState.setStyleColor(options.color);\n      break;\n    default:\n      break;\n  }\n};\nexport const setSocketListener = socket => {\n  socket.onmessage = msg => {\n    const parsedMsg = JSON.parse(msg.data);\n    if (!toolState.tool || !canvasState.ctx) return;\n    switch (parsedMsg.method) {\n      case 'draw':\n        sokcetMessageHandler(parsedMsg);\n        break;\n      case 'setting':\n        changeSetting(parsedMsg);\n        break;\n      case 'finish':\n        canvasState.pushToUndo();\n        canvasState.ctx.beginPath();\n        break;\n      default:\n        break;\n    }\n  };\n};\nexport const handlerUserConnection = (socket, id) => {\n  return username => {\n    var _canvasState$socket;\n    canvasState.setWebSocket(socket);\n    canvasState.setId(id);\n    (_canvasState$socket = canvasState.socket) === null || _canvasState$socket === void 0 ? void 0 : _canvasState$socket.send(JSON.stringify({\n      id: id,\n      method: 'connection',\n      username: username\n    }));\n  };\n};","map":{"version":3,"names":["canvasState","toolState","sokcetMessageHandler","changeSetting","msg","options","option","type","color","setStyleColor","setSocketListener","socket","onmessage","parsedMsg","JSON","parse","data","tool","ctx","method","pushToUndo","beginPath","handlerUserConnection","id","username","_canvasState$socket","setWebSocket","setId","send","stringify"],"sources":["C:/Users/mistR/OneDrive/Рабочий стол/React/ts/paint-ts/client/src/sokcet/socket.ts"],"sourcesContent":["import { MessageSettingI } from '../model/msgI';\r\nimport canvasState from '../store/canvasState';\r\nimport toolState from '../store/toolState';\r\n\r\nimport { sokcetMessageHandler } from './drawHandler';\r\n\r\nconst changeSetting = (msg: MessageSettingI) => {\r\n    const options = msg.option;\r\n\r\n    switch (options.type) {\r\n        case 'color':   \r\n            if(!options.color) return;\r\n            toolState.setStyleColor(options.color);\r\n            break;\r\n    \r\n        default:\r\n            break;\r\n    }\r\n}\r\n\r\nexport const setSocketListener = (socket: WebSocket) => {\r\n    socket.onmessage = (msg) => {\r\n        const parsedMsg = JSON.parse(msg.data);\r\n        if(!toolState.tool || !canvasState.ctx) return;\r\n\r\n        switch (parsedMsg.method) {\r\n            case 'draw':\r\n                sokcetMessageHandler(parsedMsg);\r\n                break;\r\n\r\n            case 'setting': \r\n                changeSetting(parsedMsg);\r\n                break;\r\n    \r\n            case 'finish':\r\n                canvasState.pushToUndo();\r\n                canvasState.ctx.beginPath();\r\n                break;\r\n        \r\n            default:\r\n                break;\r\n        }\r\n    \r\n    }\r\n} \r\n\r\nexport const handlerUserConnection = (socket: WebSocket, id: string): Function => {\r\n\r\n    return (username: string) => {\r\n        canvasState.setWebSocket(socket);\r\n        canvasState.setId(id);\r\n    \r\n        canvasState.socket?.send(JSON.stringify({\r\n          id: id,\r\n          method: 'connection',\r\n          username: username\r\n      }));\r\n    }\r\n  }\r\n"],"mappings":"AACA,OAAOA,WAAW,MAAM,sBAAsB;AAC9C,OAAOC,SAAS,MAAM,oBAAoB;AAE1C,SAASC,oBAAoB,QAAQ,eAAe;AAEpD,MAAMC,aAAa,GAAIC,GAAoB,IAAK;EAC5C,MAAMC,OAAO,GAAGD,GAAG,CAACE,MAAM;EAE1B,QAAQD,OAAO,CAACE,IAAI;IAChB,KAAK,OAAO;MACR,IAAG,CAACF,OAAO,CAACG,KAAK,EAAE;MACnBP,SAAS,CAACQ,aAAa,CAACJ,OAAO,CAACG,KAAK,CAAC;MACtC;IAEJ;MACI;EACR;AACJ,CAAC;AAED,OAAO,MAAME,iBAAiB,GAAIC,MAAiB,IAAK;EACpDA,MAAM,CAACC,SAAS,GAAIR,GAAG,IAAK;IACxB,MAAMS,SAAS,GAAGC,IAAI,CAACC,KAAK,CAACX,GAAG,CAACY,IAAI,CAAC;IACtC,IAAG,CAACf,SAAS,CAACgB,IAAI,IAAI,CAACjB,WAAW,CAACkB,GAAG,EAAE;IAExC,QAAQL,SAAS,CAACM,MAAM;MACpB,KAAK,MAAM;QACPjB,oBAAoB,CAACW,SAAS,CAAC;QAC/B;MAEJ,KAAK,SAAS;QACVV,aAAa,CAACU,SAAS,CAAC;QACxB;MAEJ,KAAK,QAAQ;QACTb,WAAW,CAACoB,UAAU,CAAC,CAAC;QACxBpB,WAAW,CAACkB,GAAG,CAACG,SAAS,CAAC,CAAC;QAC3B;MAEJ;QACI;IACR;EAEJ,CAAC;AACL,CAAC;AAED,OAAO,MAAMC,qBAAqB,GAAGA,CAACX,MAAiB,EAAEY,EAAU,KAAe;EAE9E,OAAQC,QAAgB,IAAK;IAAA,IAAAC,mBAAA;IACzBzB,WAAW,CAAC0B,YAAY,CAACf,MAAM,CAAC;IAChCX,WAAW,CAAC2B,KAAK,CAACJ,EAAE,CAAC;IAErB,CAAAE,mBAAA,GAAAzB,WAAW,CAACW,MAAM,cAAAc,mBAAA,uBAAlBA,mBAAA,CAAoBG,IAAI,CAACd,IAAI,CAACe,SAAS,CAAC;MACtCN,EAAE,EAAEA,EAAE;MACNJ,MAAM,EAAE,YAAY;MACpBK,QAAQ,EAAEA;IACd,CAAC,CAAC,CAAC;EACL,CAAC;AACH,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}