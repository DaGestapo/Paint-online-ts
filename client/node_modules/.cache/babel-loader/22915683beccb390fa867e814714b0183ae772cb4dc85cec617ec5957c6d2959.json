{"ast":null,"code":"import canvasState from '../store/canvasState';\nexport const storeHandler = msg => {\n  switch (msg.type) {\n    case 'undo':\n      undoHandler(msg.id);\n      break;\n    case 'redo':\n      redoHandler(msg.id);\n      break;\n    default:\n      break;\n  }\n};\nfunction redoHandler(id) {\n  if (!canvasState.socket) return;\n  const lockStore = localStorage.getItem(id);\n  if (!lockStore) return;\n  const undoArr = JSON.parse(lockStore).redo;\n  if (undoArr.length !== 0) {\n    let src = undoArr[undoArr.length - 1];\n    if (!src) return;\n    const img = document.createElement('img');\n    img.src = src;\n    img.onload = () => {\n      if (!canvasState.ctx) return;\n      canvasState.ctx.clearRect(0, 0, 600, 400);\n      canvasState.ctx.drawImage(img, 0, 0, 600, 400);\n    };\n  }\n}\nfunction undoHandler(id) {\n  if (!canvasState.socket) return;\n  const lockStore = localStorage.getItem(id);\n  if (!lockStore) return;\n  const redoArr = JSON.parse(lockStore).redo;\n  if (redoArr.length !== 0) {\n    let src = redoArr[redoArr.length - 1];\n    if (!src) return;\n    const img = document.createElement('img');\n    img.src = src;\n    img.onload = () => {\n      if (!canvasState.ctx) return;\n      canvasState.ctx.clearRect(0, 0, 600, 400);\n      canvasState.ctx.drawImage(img, 0, 0, 600, 400);\n    };\n  }\n}","map":{"version":3,"names":["canvasState","storeHandler","msg","type","undoHandler","id","redoHandler","socket","lockStore","localStorage","getItem","undoArr","JSON","parse","redo","length","src","img","document","createElement","onload","ctx","clearRect","drawImage","redoArr"],"sources":["C:/Users/mistR/OneDrive/Рабочий стол/React/ts/paint-ts/client/src/sokcet/storeHandler.ts"],"sourcesContent":["import { StoreI } from '../model/msgI';\r\nimport canvasState from '../store/canvasState';\r\n\r\nexport const storeHandler = (msg: StoreI) => {\r\n\r\n    switch (msg.type) {\r\n        case 'undo':\r\n            undoHandler(msg.id);\r\n            break;\r\n\r\n        case 'redo': \r\n            redoHandler(msg.id);\r\n            break;\r\n\r\n        default:\r\n            break;\r\n    }\r\n}\r\n\r\nfunction redoHandler(id: string) {\r\n    if(!canvasState.socket) return;\r\n    const lockStore = localStorage.getItem(id);\r\n    if(!lockStore) return;\r\n\r\n    const undoArr: string[] = JSON.parse(lockStore).redo;\r\n    if(undoArr.length !== 0) {\r\n        let src = undoArr[undoArr.length - 1];\r\n        if(!src) return;\r\n        \r\n        const img = document.createElement('img');\r\n        img.src = src;\r\n        img.onload = () => {\r\n        if(!canvasState.ctx) return;\r\n        canvasState.ctx.clearRect(0, 0, 600, 400);\r\n        canvasState.ctx.drawImage(img, 0, 0, 600, 400);\r\n    }\r\n}\r\n}\r\n\r\n\r\nfunction undoHandler(id: string) {\r\n    if(!canvasState.socket) return;\r\n    const lockStore = localStorage.getItem(id);\r\n    if(!lockStore) return;\r\n\r\n    const redoArr: string[] = JSON.parse(lockStore).redo;\r\n    if(redoArr.length !== 0) {\r\n        let src = redoArr[redoArr.length - 1];\r\n        if(!src) return;\r\n        \r\n        const img = document.createElement('img');\r\n        img.src = src;\r\n        img.onload = () => {\r\n        if(!canvasState.ctx) return;\r\n        canvasState.ctx.clearRect(0, 0, 600, 400);\r\n        canvasState.ctx.drawImage(img, 0, 0, 600, 400);\r\n    }\r\n}\r\n}"],"mappings":"AACA,OAAOA,WAAW,MAAM,sBAAsB;AAE9C,OAAO,MAAMC,YAAY,GAAIC,GAAW,IAAK;EAEzC,QAAQA,GAAG,CAACC,IAAI;IACZ,KAAK,MAAM;MACPC,WAAW,CAACF,GAAG,CAACG,EAAE,CAAC;MACnB;IAEJ,KAAK,MAAM;MACPC,WAAW,CAACJ,GAAG,CAACG,EAAE,CAAC;MACnB;IAEJ;MACI;EACR;AACJ,CAAC;AAED,SAASC,WAAWA,CAACD,EAAU,EAAE;EAC7B,IAAG,CAACL,WAAW,CAACO,MAAM,EAAE;EACxB,MAAMC,SAAS,GAAGC,YAAY,CAACC,OAAO,CAACL,EAAE,CAAC;EAC1C,IAAG,CAACG,SAAS,EAAE;EAEf,MAAMG,OAAiB,GAAGC,IAAI,CAACC,KAAK,CAACL,SAAS,CAAC,CAACM,IAAI;EACpD,IAAGH,OAAO,CAACI,MAAM,KAAK,CAAC,EAAE;IACrB,IAAIC,GAAG,GAAGL,OAAO,CAACA,OAAO,CAACI,MAAM,GAAG,CAAC,CAAC;IACrC,IAAG,CAACC,GAAG,EAAE;IAET,MAAMC,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IACzCF,GAAG,CAACD,GAAG,GAAGA,GAAG;IACbC,GAAG,CAACG,MAAM,GAAG,MAAM;MACnB,IAAG,CAACpB,WAAW,CAACqB,GAAG,EAAE;MACrBrB,WAAW,CAACqB,GAAG,CAACC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC;MACzCtB,WAAW,CAACqB,GAAG,CAACE,SAAS,CAACN,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC;IAClD,CAAC;EACL;AACA;AAGA,SAASb,WAAWA,CAACC,EAAU,EAAE;EAC7B,IAAG,CAACL,WAAW,CAACO,MAAM,EAAE;EACxB,MAAMC,SAAS,GAAGC,YAAY,CAACC,OAAO,CAACL,EAAE,CAAC;EAC1C,IAAG,CAACG,SAAS,EAAE;EAEf,MAAMgB,OAAiB,GAAGZ,IAAI,CAACC,KAAK,CAACL,SAAS,CAAC,CAACM,IAAI;EACpD,IAAGU,OAAO,CAACT,MAAM,KAAK,CAAC,EAAE;IACrB,IAAIC,GAAG,GAAGQ,OAAO,CAACA,OAAO,CAACT,MAAM,GAAG,CAAC,CAAC;IACrC,IAAG,CAACC,GAAG,EAAE;IAET,MAAMC,GAAG,GAAGC,QAAQ,CAACC,aAAa,CAAC,KAAK,CAAC;IACzCF,GAAG,CAACD,GAAG,GAAGA,GAAG;IACbC,GAAG,CAACG,MAAM,GAAG,MAAM;MACnB,IAAG,CAACpB,WAAW,CAACqB,GAAG,EAAE;MACrBrB,WAAW,CAACqB,GAAG,CAACC,SAAS,CAAC,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC;MACzCtB,WAAW,CAACqB,GAAG,CAACE,SAAS,CAACN,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,EAAE,GAAG,CAAC;IAClD,CAAC;EACL;AACA"},"metadata":{},"sourceType":"module","externalDependencies":[]}